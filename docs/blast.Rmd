---
title: "Basic Local Alignment Search Tool (BLAST)"
author: "Prof. Harbert"
date: "October 1, 2018"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# BLAST

# Get Data

We will attempt to search human transcriptome data against the human genome using NCBI RefSeq data.

First, set up a working directory:

```{bash, eval =FALSE}
mkdir blast
cd blast
mkdir data
mkdir src


```

Then, download data into the data folder

```{bash, eval=FALSE}

curl ftp://ftp.ncbi.nlm.nih.gov/refseq/H_sapiens/annotation/GRCh38_latest/refseq_identifiers/GRCh38_latest_genomic.fna.gz  > data/genome.fna.gz


curl ftp://ftp.ncbi.nlm.nih.gov/refseq/H_sapiens/annotation/GRCh38_latest/refseq_identifiers/GRCh38_latest_rna.fna.gz  > data/transcripts.fna.gz


```

And get BLAST:

For Mac users:

```{bash, eval = FALSE}
curl ftp://ftp.ncbi.nlm.nih.gov/blast/executables/blast+/LATEST/ncbi-blast-2.7.1+-x64-macosx.tar.gz > blast.tar.gz

tar -xzf blast.tar.gz

```

For Windwows users:

```{bash, eval=FALSE}
curl ftp://ftp.ncbi.nlm.nih.gov/blast/executables/blast+/LATEST/ncbi-blast-2.7.1+-x64-win64.tar.gz > blast.tar.gz

tar -xzf blast.tar.gz
```

Confirm that you have a folder called ncbi-blast-2.7.1+ or similar and remove the blast.tar.gz file (hint use 'ls' and 'rm' commands).


tar flags: https://xkcd.com/1168/


# BLAST: Make Database from Genome File

The first step to running a blast analysis on your machine is to build your database. We will be using the genome file for that purpose.

```{bash, eval=FALSE}
gunzip data/genome.fna.gz

ncbi-blast-2.7.1+/bin/makeblastdb.exe -in data/genome.fna -dbtype nucl -title human


```

```{bash, eval=FALSE}
gunzip data/transcripts.fna.gz
head -10000 data/transcripts.fna > data/subtranscripts.fna

ncbi-blast-2.7.1+/bin/blastn.exe -db data/genome.fna -query data/subtranscripts.fna -outfmt 6 -max_target_seqs 1 -num_threads 2 -out blastout.tab


```

We can look at the blastout.tab file using cat or head:

```{bash, eval=FALSE}
head blastout.tab
```

And if we want to know what the
